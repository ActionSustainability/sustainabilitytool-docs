buildPack: javascript
pipelineConfig:
  pipelines:
    release:
      build:
        replace: true
        steps:
        - command: npm install
        - command: node --experimental-modules code/updateIndex.mjs
        - command: node --experimental-modules code/updateTOC.mjs
        - command: npm run build
      promote:
        steps:
        - command: if [ "$BRANCH_NAME" == 'master' ]; then export S3_BUNDLE_PATH='docs.sustainabilitytool.com/stable/'; else export S3_BUNDLE_PATH='docs.sustainabilitytool.com/latest/'; fi
        - command: echo S3_BUNDLE_PATH